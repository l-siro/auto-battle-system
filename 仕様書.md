

## 概要
JavaScriptを用いて自動戦闘のゲームのコード生成

## 画面構成
- 行動順確認画面：画面左上、キャラクターの名前を上から行動順に表示、現在行動中のキャラクターをハイライト
- 戦闘画面：画面中央大きく、キャラクターのコマを配置、左側に味方、右側に敵を配置、各種エフェクトやダメージ数値表示、HP回復数値表示などやHPとSPのインジケーター表示で分かりやすく。
- ファイルアップロードと戦闘開始ボタン：戦闘画面直下、inputでjsonファイルをアップロードと下記の戦闘開始時に押すためのボタン
- ログ出力画面：画面下部、キャラクターの行動のログを出力。

## 全体の流れ
1. アップロードされたjsonファイルからキャラクターデータを読み込み
2. キャラクターデータを元にステータスを生成
3. ステータスを元に戦闘画面にキャラクターのコマを生成、名前、HP、SPなどを表示
4. キャラクターのコマ毎に「作戦」のセレクトボックスを追加。
5. ステータスのspeedを元に行動順を設定
6. 戦闘画面とは別に行動順確認画面に行動順でコマを配置
7. 戦闘開始ボタンを押され次第、行動順に戦闘処理を実行
8. キャラクターコマのセレクトボックスで選択されたの「作戦」に基づいて戦闘処理を選択
9.  戦闘処理の成功判定、結果に応じた画面エフェクトの実行
10. ステータスに戦闘処理の結果を反映、ログに記録
11. 敵、もしくは味方全員のHPが0になった場合は戦闘終了処理、リザルト表示
12. ステータスの変動に合わせて、行動順を再計算し行動順確認用画面に行動順でコマを再配置
13. 6.に戻る。ココまでのサイクルを1ターンとする。5回繰り返して13.の処理を挟む
14. 一時停止して、「作戦」を再選択する時間。戦闘開始を再度押して、処理再開。

## jsonファイルには以下のデータが含まれる
### キャラクターのデータフォーマット
- 味方 or 敵
- 名前
- 生命力:vitality（1~100）
- 筋力:strength（1~100）
- 器用度:dexterity（1~100）
- 敏捷性:agility（1~100）
- 知力:intelligence（1~100）
- 精神力:spirit（1~100）
- 苦手属性
- 経験値
- 所持スキル
- 所持アイテム

## キャラクターステータスを計算式
hp (体力): vitality * 10
maxHP (最大体力): vitality * 10
sp (スキルポイント): intelligence * 5
maxSP (最大スキルポイント): intelligence * 5
attack (攻撃力): strength * 2
defense (防御力): vitality * 2
accuracy (命中率): dexterity / 100
evasion (回避率): agility / 100
speed (素早さ): agility / 2
shield (属性障壁): Math.floor(spirit / 20);
## スキルのデータフォーマット
- 名前
- 効果
- 効果量
- 効果対象
- 消費AP
- 命中率
- 属性
- エフェクトタイプ
- 行動タイプ

## 命中判定
通常攻撃の命中判定。スキルの場合はデータの命中率から計算
``` JavaScript
function calculateHitRate(accuracy, evasion) {
  var diff = accuracy - evasion;
  var hitRate = 50;
  if (diff > 0) {
    hitRate += diff * 0.5;
  }
  return hitRate;
}
```

## 武器のデータフォーマット
- 武器名
sp (スキルポイント)
maxSP (最大スキルポイント)
attack (攻撃力)
defense (防御力)
accuracy (命中率)
evasion (回避率)
speed (素早さ)
shield (属性障壁)
- 属性

剣（Sword）
弓（Bow）
杖（Staff）
斧（Axe）
大盾（Shield）

## アイテムのデータフォーマット
- 名前
- 効果
- 効果量
- 効果対象
- 残数
- 属性
- エフェクトタイプ
- 行動タイプ

## スキルデータフォーマット
- 名前
- 効果
- 属性
- エフェクトタイプ
- 行動タイプ

## 効果タイプ
- ステータス変更
- 

## 属性の種類
- fire = "火属性";
- water = "水属性";
- thunder = "雷属性";
- light = "光属性";
- darkness = "闇属性";
- striking = "打撃属性";
- slashing = "斬撃属性";
- piercing = "流撃属性";

## エフェクトの種類
- 回復
- 攻撃
- ステータス上昇
- ステータス低下
- 解除
- 火属性
- 水属性
- 雷属性
- 光属性
- 闇属性
- 打撃属性
- 斬撃属性
- 流撃属性

## 行動タイプと条件
- 攻撃：HPが0ではない敵がいる場合
- 回復：HPが最大ではない味方（自分も含む）がいる場合
- その他：ランダムで一定確率行動する

## 状態異常
- 速度低下：一回行動をパス
- 速度上昇：一回行動をパス

## 作戦
基本は全てランダムで戦略によって行動パターンが変わります。

### ガンガンいこうぜ
行動タイプ:攻撃 を優先して選ぶ
80%くらい

### 命大事に
行動タイプ:回復 を優先して選ぶ
80%くらい

### 慎重
基本は通常攻撃のみでターゲットのHPが半分以下の場合にのみ、
通常攻撃、スキル、アイテムをランダムで行います。

### 反撃
自分を攻撃してきた相手を攻撃する。

### アイテム優先
アイテムを優先的に使用します。
アイテムが使える場合は50%の確率でアイテムを使用します。

### スキル優先
スキルを優先的に使用します。
スキルが使える場合は50%の確率でスキルを使用します。

### 大物狙い
最大HPの多い敵を狙います。

### 小物狙い
最大HPの少ない敵を狙います。

### トドメ
現在HPの少ない敵を狙います。